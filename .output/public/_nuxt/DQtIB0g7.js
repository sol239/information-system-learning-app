import{_ as z}from"./Djub6ojE.js";import{f as U,x as V,g as P,ab as q,C as b,z as W,c as d,b as _,a as e,S as M,F as C,r as E,t as i,h as s,w as x,i as Y,o as h,d as v,ah as Z,T as Q,az as A,_ as G}from"./j0WNL21o.js";import{S as J}from"./B_2Y0efC.js";import{P as K}from"./z1NFFN3t.js";import{S as X}from"./C5RhWAj9.js";import{u as tt}from"./CEer_hvB.js";const et={class:"container mx-auto px-4 py-8"},st={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},it={class:"session-header"},at={class:"flex items-center justify-between mb-4"},ot={class:"text-xl font-semibold text-gray-900"},nt=["id","onClick"],ct=["id","onClick"],lt={class:"flex items-center justify-between mb-2"},rt={class:"text-sm font-medium text-gray-700"},dt={class:"text-sm text-gray-600"},ht={class:"capacity-bar"},mt={class:"text-xs text-gray-500 mt-1"},gt=["id","onClick"],_t={class:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2"},ut={key:0,class:"space-y-2"},pt={class:"participant-avatar"},yt={class:"participant-info"},vt={class:"participant-name"},ft={class:"participant-details"},bt={key:0,class:"text-xs text-gray-500"},xt={key:1,class:"text-sm text-gray-500 italic"},St=["id","onClick"],kt={class:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2"},Ct={key:0,class:"space-y-2"},Et={class:"supervisor-avatar"},Ht={class:"supervisor-info"},Dt={class:"supervisor-name"},Mt={class:"supervisor-details"},It={key:1,class:"text-sm text-gray-500 italic"},Rt={class:"session-actions mt-6 pt-4 border-t border-gray-200"},$t={class:"flex gap-2"},Ot={key:0,class:"empty-state"},Ft={class:"empty-title"},Bt={class:"empty-description"},Lt=U({__name:"sessions",setup(Tt){const g=V(),{t:c}=P(),l=q(),I=b([{label:c("dashboard"),icon:"i-heroicons-chart-bar-20-solid",to:`/system/${g.selectedId}/dashboard`,data_target:"system-dashboard"},{label:c("sessions"),icon:"i-heroicons-calendar-date-range",to:`/system/${g.selectedId}/sessions`,data_target:"system-sessions"},{label:c("participants"),to:`/system/${g.selectedId}/participants`,data_target:"system-participants"},{label:c("supervisors"),to:`/system/${g.selectedId}/supervisors`,data_target:"system-supervisors"},{label:c("database"),icon:"i-heroicons-table-cells",to:`/system/${g.selectedId}/database`,data_target:"system-table"}]),S=b([]),H=b([]),R=b(!1),$=b(null),O=()=>{var n;if(!((n=g.selectedSystem)!=null&&n.db)){console.error("Database not available");return}try{const o=g.selectedSystem.db.query("SELECT * FROM turnusy ORDER BY id");if(o.success){const r=o.results.map(m=>{var a;const p=(a=g.selectedSystem)==null?void 0:a.db.query("SELECT * FROM účastníci WHERE turnus_id = ?",[m.id]),t=p!=null&&p.success?p.results.map(y=>new K(y.id,y.jméno,y.email,y.rodné_číslo,y.telefon,y.adresa,y.věk,y.turnus_id)):[];return new J(m.id,new Date(m.od),new Date(m.do),m.kapacita,t)});S.value=r}const u=g.selectedSystem.db.query("SELECT * FROM vedoucí ORDER BY id");u.success&&(H.value=u.results.map(r=>new X(r.id,r.jméno,r.email,r.rodné_číslo,r.telefon,r.adresa,r.věk,r.turnus_id)))}catch(o){console.error("Error loading data from database:",o)}},f=n=>Math.round(n.participants.length/n.capacity*100),F=n=>{const o=f(n);return o>=90?"#ef4444":o>=70?"#f59e0b":"#10b981"},B=n=>{if(n.ifFull())return c("full");const o=f(n);return o>=70?c("almost_full"):o>0?c("available"):c("empty")},L=n=>{if(n.ifFull())return"red";const o=f(n);return o>=70?"yellow":o>0?"green":"neutral"},T=(n,o)=>{const u=n.toLocaleDateString("cs-CZ",{day:"numeric",month:"short"}),r=o.toLocaleDateString("cs-CZ",{day:"numeric",month:"short",year:"numeric"});return`${u} - ${r}`},D=n=>n.split(" ").map(o=>o[0]).join("").toUpperCase(),k=n=>{const o=H.value.filter(u=>u.sessionId===n);return console.log("SUPERVISORS: ",o),o},w=n=>{$.value=n,R.value=!0},N=n=>{console.log("Managing session:",n.id)};tt(l.highlightHandler,l);const j=()=>{console.log("Creating new session")};return W(()=>{O()}),(n,o)=>{const u=z,r=Z,m=Q,p=Y;return h(),d("div",null,[_(u,{items:I.value},null,8,["items"]),e("div",et,[e("div",st,[(h(!0),d(C,null,E(S.value,t=>(h(),d("div",{key:t.id,class:"session-card"},[e("div",it,[e("div",at,[e("h3",ot,i(s(c)("session"))+" "+i(t.id),1),_(r,{class:"highlightable",color:L(t),variant:"soft",id:"sessions-status-"+t.id,onClick:a=>s(l).isHighlightMode&&s(l).highlightHandler.selectElement("sessions-status-"+t.id,a)},{default:x(()=>[v(i(B(t)),1)]),_:2},1032,["color","id","onClick"])]),e("div",{class:"flex items-center gap-2 text-sm text-gray-600 mb-4 highlightable",id:"sessions-date-"+t.id,onClick:a=>s(l).isHighlightMode&&s(l).highlightHandler.selectElement("sessions-date-"+t.id,a)},[_(m,{name:"i-heroicons-calendar-days"}),e("span",null,i(T(t.fromDate,t.toDate)),1)],8,nt)]),e("div",{class:"capacity-section mb-6 highlightable",id:"sessions-capacity-"+t.id,onClick:a=>s(l).isHighlightMode&&s(l).highlightHandler.selectElement("sessions-capacity-"+t.id,a)},[e("div",lt,[e("span",rt,i(s(c)("capacity")),1),e("span",dt,i(t.participants.length)+"/"+i(t.capacity),1)]),e("div",ht,[e("div",{class:"capacity-fill",style:A({width:f(t)+"%",backgroundColor:F(t)})},null,4)]),e("div",mt,i(f(t))+"% "+i(s(c)("occupied")),1)],8,ct),e("div",{class:"participants-section mb-6 highlightable",id:"sessions-participants-"+t.id,onClick:a=>s(l).isHighlightMode&&s(l).highlightHandler.selectElement("sessions-participants-"+t.id,a)},[e("h4",_t,[_(m,{name:"i-heroicons-users"}),v(" "+i(s(c)("participants"))+" ("+i(t.participants.length)+") ",1)]),t.participants.length>0?(h(),d("div",ut,[(h(!0),d(C,null,E(t.participants.slice(0,3),a=>(h(),d("div",{key:a.id,class:"participant-item"},[e("div",pt,i(D(a.name)),1),e("div",yt,[e("div",vt,i(a.name),1),e("div",ft,i(s(c)("age"))+": "+i(a.age),1)])]))),128)),t.participants.length>3?(h(),d("div",bt," + "+i(t.participants.length-3)+" "+i(s(c)("more_participants")),1)):M("",!0)])):(h(),d("div",xt,i(s(c)("no_participants")),1))],8,gt),e("div",{class:"supervisors-section mb-6 highlightable",id:"sessions-supervisors-"+t.id,onClick:a=>s(l).isHighlightMode&&s(l).highlightHandler.selectElement("sessions-supervisors-"+t.id,a)},[e("h4",kt,[_(m,{name:"i-heroicons-user-group"}),v(" "+i(s(c)("supervisors"))+" ("+i(k(t.id).length)+") ",1)]),k(t.id).length>0?(h(),d("div",Ct,[(h(!0),d(C,null,E(k(t.id),a=>(h(),d("div",{key:a.id,class:"supervisor-item"},[e("div",Et,i(D(a.name)),1),e("div",Ht,[e("div",Dt,i(a.name),1),e("div",Mt,i(a.email),1)])]))),128))])):(h(),d("div",It,i(s(c)("no_supervisors")),1))],8,St),e("div",Rt,[e("div",$t,[e("div",null,[_(p,{size:"sm",variant:"outline",onClick:a=>s(l).isHighlightMode?s(l).isHighlightMode&&s(l).highlightHandler.selectElement("sessions-view-"+t.id,a):w(t),class:"flex-1 highlightable",id:"sessions-view-"+t.id},{default:x(()=>o[0]||(o[0]=[v("h TO-DO ")])),_:2,__:[0]},1032,["onClick","id"])]),_(p,{size:"sm",color:"primary",onClick:a=>s(l).isHighlightMode?s(l).isHighlightMode&&s(l).highlightHandler.selectElement("sessions-manage-"+t.id,a):N(t),class:"flex-1 highlightable",id:"sessions-manage-"+t.id},{default:x(()=>o[1]||(o[1]=[v(" TO-DO ")])),_:2,__:[1]},1032,["onClick","id"])])])]))),128))]),S.value.length===0?(h(),d("div",Ot,[_(m,{name:"i-heroicons-calendar-x-mark",class:"empty-icon"}),e("h3",Ft,i(s(c)("no_sessions")),1),e("p",Bt,i(s(c)("no_sessions_description")),1),_(p,{onClick:j,class:"mt-4"},{default:x(()=>[v(i(s(c)("create_session")),1)]),_:1})])):M("",!0)])])}}}),Pt=G(Lt,[["__scopeId","data-v-7deae0af"]]);export{Pt as default};
